# 함수형 프로그래밍

함수형 프로그래밍은 프로그래밍 패러다임 중 하나다.

클로저는 함수형 프로그래밍을 기반으로 하고 있다.

시간이 흐름에 따라 조건에 따른 상태를 바꿔 결과를 내는 명령형 패러다임과는 다르게 함수의 조합으로 결과를 표현하는 방식이다.

실제로 함수 조합은 단순하고 확장성이 뛰어나기 때문에 특별한 규칙없이 함수 조합만으로 숫자를 표현하거나 사칙 연산을 하거나 분기문, 반복문등을 표현할 수 있다.

하지만 현대 함수형 프로그래밍 언어들은 연산 함수, 분기 처리, 함수 재귀등을 제공하기 때문에 람다 계산법을 이해하지 못해도 쉽게 프로그래밍을 작성할 수 있다.

그래도 함수형 프로그래밍을 잘 하려면 람다 계산법과 함수형 프로그래밍의 많은 기법들을 익혀야 복잡한 프로그램을 더 잘 표현할 수 있다.

이 글은 클로저를 처음 접하는 사람들을 위한 글이기 때문에 함수형 프로그래밍 기법을 다루지는 않고 가벼운 마음으로  명령형 프로그램에 비교해서 클로저에서 함수형 프로그래밍 스타일로 어떻게 작성하는지 예제를 통해 정리해보려고 한다.

함수형 프로그래밍을 알고 싶다면 먼저 람다 계산법을 익힌 후 SICP 책과 하스켈 언어와 같은 것을 공부하면 도움이 될 것 같다.

## 변경 불가능한 데이터

함수형 프로그래밍에서는 상태의 개념이 없기 때문에 클로저 값은 변하지 않는다.

```clojure
user=> (def user {:id 1 :name "eunmin" :level 10})
#'user/user
user=> (update-in user [:level] inc)
{:name "eunmin", :level 11, :id 1}
user=> user
{:name "eunmin", :level 10, :id 1}
user=> (update-in user [:level] inc)
{:name "eunmin", :level 11, :id 1}
user=> (update-in user [:level] inc)
{:name "eunmin", :level 11, :id 1}
```

위의 예제는 `user`라는 이름을 가지는 맵에 `:level` 값을 하나 증가시키는 예제다.

`update-in` 함수로 맵에 있는 값을 변경했지만 리턴되는 맵은 변경 된 값을 가진 새로운 맵을 리턴하고 원래 `user` 값은 그대로 있다.

클로저의 값은 이렇게 기존 값을 변경하지 않고 새로운 값을 리턴한다. 

크기가 큰 리스트나 벡터도 하나의 항목 값만 바뀌어도 새로운 값을 리턴한다.

매번 새로운 데이터가 생기면 메모리 낭비가 아닌가하는 우려가 있을 수 있는데 내부적으로 참조를 사용하여 데이터가 중복되지 않도록 설계되어 있기 때문에 걱정하지 않아도 된다.

## 반복문

함수형 프로그래밍에서는 프로그램이 명령어를 순차적으로 실행하지 않기 때문에 '이것 다음에 저것이 실행되라'와 같은 개념이 없다. 따라서 반복문이라는 개념이 존재하지 않는다.

대신 대부분의 언어에서 제공하고 있는 재귀 함수를 통해 함수를 여러번 적용하는 것으로 반복문을 표현한다.

보통 반복문에서 처리하는 데이터는 반복이 될 때마다 값을 변경해서 데이터를 처리하는데 클로저는 값을 변경하는 방법이 없기 때문에 파라미터를 이용해 마치 변경된 값을 전달하는 것처럼 표현한다.

```clojure
user=> (def user {:id 1 :name "eunmin" :level 10})
#'user/user
user=> (defn inc-level [user data]
  #_=>   (if (empty? data)
  #_=>     user
  #_=>     (inc-level (update-in user [:level] #(+ (first data) %)) (rest data))))
user=> (inc-level user [1 5 1 2])
{:name "eunmin", :level 19, :id 1}
```

위의 예제는 `user`라는 데이터에 `:level`을 증가시키는 예제다.

앞선 예제와 다른 점은 증가시킬 값을 여러개 받아 증가시키는 예제다. 

물론 실제 프로그램에서는 여러개 받은 값을 모두 더해서 한번에 증가시켜도 되지만 반복이라는 예제를 설명하기 위해서 데이터의 개수 만큼 반복하는 것처러 작성했다.

예제를 보면 `inc-level` 함수 안에서 `inc-level` 함수를 다시 부른다.

다시 부를 때는 

첫번째 파라미터에 `user` 값에 `data`이 들어온 값에 기존 `:level`값을 더한 `user`를 가지고 부르고

두번째 파라미터에 첫번째 항목을 없앤 `data`를 넣어 부른다.

그리고 `data`가 비어 있다면 `user`를 리턴한다.




